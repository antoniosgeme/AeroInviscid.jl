# AeroInviscid.jl

Lightweight 2D inviscid aerodynamics in Julia: linear vortex panel method for single and multi-element airfoils, plus plotting recipes for Cp and pretty streamlines.

## Features

- Linear vortex-sheet panel solver (Kutta condition) for Airfoil and MultielementAirfoil
- Fast, low-allocation induced velocity on grids (threaded over field points)
- Plot recipes:
	- `plot(sol)` for Cp distribution on the geometry
	- `flowplot(sol; ...)` using PrettyStreamlines for Cp-colored streamlines on a black background
- Geometry helpers: `shift_scale_rotate`, `element_coordinates` for unified single/multi-element handling

## Installation

This repo is a standard Julia package. From a Julia REPL:

```julia
using Pkg
# Option A: develop locally (editable)
Pkg.develop(path="/path/to/AeroInviscid.jl")

# Option B: add by URL
# Pkg.add(url="https://github.com/antoniosgeme/AeroInviscid.jl")
```

You will also want a plotting backend to see recipes:

```julia
using Pkg
Pkg.add(["Plots", "PrettyStreamlines"])  # PrettyStreamlines used by flowplot recipe
```

## Quick start

### Single airfoil

```julia
using AeroGeometry
using AeroInviscid
using Plots

af = Airfoil("NACA4412")
ip = InviscidProblem(af, 10.0)    # α = 10 degrees
sol = solve(ip)

# Cp distribution
plot(sol, title="Pressure Coefficient", xlabel="x", ylabel="C_p")

# Flow visualization
flowplot(sol; xlims=(-1, 2), ylims=(-1, 1), min_density=2, max_density=10, linewidth=1.0, clims=(-5, 1))
```

### Multi-element airfoil

```julia
using AeroGeometry
using AeroInviscid
using Plots
using LaTeXStrings

airfoils = [Airfoil("NACA" * i) for i in ["6412","8412","4412"]]
chord   = [1.0, 0.5, 0.3]
pitch   = [0.0, 30.0, 50.0]
le_loc  = [[0.0,0.0],[0.9,-0.15],[1.2,-0.45]]

me = MultielementAirfoil(airfoils, pitch, chord, le_loc)
ip = InviscidProblem(me, 0.0)
sol = solve(ip)

p1 = plot(sol, title="Pressure Coefficient Distribution", xlabel=L"x", ylabel=L"C_p")
xlims!(p1, -1, 2.6); ylims!(p1, -15, 3)

p2 = flowplot(sol, title="Flow Field around Multielement Airfoil", xlabel=L"x", ylabel=L"y")

plot(p1, p2, layout=(2,1), size=(800,1000))
```

The file `scripts/MultiElement.jl` contains a full, runnable example.

## Programmatic field evaluation

Compute induced velocities on a grid and build your own visualization:

```julia
xs = range(-1, 2, length=300)
ys = range(-1, 1, length=200)
X  = repeat(permutedims(collect(xs)), length(ys), 1)
Y  = repeat(collect(ys), 1, length(xs))

U, V = AeroInviscid.induced_velocity(sol, X, Y)
Cp   = 1 .- (U.^2 .+ V.^2)
```

## Geometry coordinates for plotting/masking

Use `element_coordinates` to get iterable Nx2 matrices, regardless of single vs multi-element geometries:

```julia
for coords in element_coordinates(sol.geometry)
		x = coords[:, 1]
		y = coords[:, 2]
		# plot shape, build masks, etc.
end
```

## Performance notes

- `induced_velocity` avoids forming Nc×Nv intermediate arrays and is threaded over field points.
- To enable threading, start Julia with multiple threads (e.g. set `JULIA_NUM_THREADS`), or configure threads in VS Code / your REPL.
- You can check the number of threads via:

```julia
Base.Threads.nthreads()
```

For large grids and many elements, this provides substantial speedups with modest memory use.

## API reference (selected)

- `InviscidProblem(geom, α)` and `solve(ip)` → returns `InviscidSolution`
- `induced_velocity(sol, X, Y)` → velocity field on a grid
- `plot(sol)` → Cp distribution
- `flowplot(sol; ...)` → Cp-colored streamlines using PrettyStreamlines
- `element_coordinates(geom)` → `Vector{Matrix{Float64}}` of element coordinates

## Acknowledgments

Relies on [AeroGeometry.jl](https://github.com/antoniosgeme/AeroGeometry.jl) for airfoil geometry and uses plotting recipes via RecipesBase. Streamlines are generated by [PrettyStreamlines.jl](https://github.com/JuliaPlots/PrettyStreamlines.jl).
